---
name: planning-with-files
description: Transforms workflow to use Manus-style persistent markdown files for planning, progress tracking, and knowledge storage. 中文：将工作流改造成使用 Manus 风格的持久化 Markdown 文件来做计划、追踪进度与沉淀知识；适用于复杂任务、多步骤项目、调研任务，或用户提到规划/组织工作/跟踪进度/需要结构化输出时。
---

# 用文件规划（Planning with Files）

像 Manus 一样工作：用持久化的 Markdown 文件作为“写在磁盘上的工作记忆”。

## 快速开始

在任何复杂任务开始前：

1. 在工作目录中 **创建 `task_plan.md`**
2. 用复选框 **定义阶段**
3. 每完成一个阶段就 **更新**：勾选 `[x]` 并修改状态
4. 做重大决策前 **先阅读计划**：把目标刷新到注意力窗口

## 三文件模式

对每个非 trivial（不止一两步）的任务，都创建三个文件：

| 文件 | 作用 | 何时更新 |
|------|------|----------|
| `task_plan.md` | 追踪阶段与进度 | 每完成一个阶段后 |
| `notes.md` | 存放调研与发现 | 调研过程中 |
| `[deliverable].md` | 最终交付物 | 完成时 |

## 核心工作流

```
循环 1：创建 task_plan.md，写清目标与阶段
循环 2：调研 → 写入 notes.md → 更新 task_plan.md
循环 3：阅读 notes.md → 生成交付物 → 更新 task_plan.md
循环 4：交付最终产物
```

### 循环细节

**每次重大行动前：**
```bash
Read task_plan.md  # 刷新目标到注意力窗口
```

**每完成一个阶段后：**
```bash
Edit task_plan.md  # 勾选 [x]，更新状态
```

**需要存放信息时：**
```bash
Write notes.md     # 别塞爆上下文，把内容写进文件
```

## task_plan.md 模板

任何复杂任务都应先创建这个文件：

```markdown
# 任务计划：[简要描述]

## 目标
[用一句话描述最终产出/状态]

## 阶段
- [ ] 阶段 1：计划与准备
- [ ] 阶段 2：调研/收集信息
- [ ] 阶段 3：执行/构建
- [ ] 阶段 4：复查与交付

## 关键问题
1. [要回答的问题]
2. [要回答的问题]

## 已做决策
- [决策]：[理由]

## 遇到的错误
- [错误]：[解决方式]

## 状态
**当前处于阶段 X** —— [我正在做什么]
```

## notes.md 模板

用于调研与发现：

```markdown
# 笔记：[主题]

## 来源

### 来源 1：[名称]
- URL：[链接]
- 要点：
  - [发现]
  - [发现]

## 综合整理

### [分类]
- [发现]
- [发现]
```

## 关键规则

### 1. 永远先建计划
不要在没有 `task_plan.md` 的情况下开始复杂任务。这一点不容妥协。

### 2. 先读再决定
做任何重大决策前，先读计划文件，把目标拉回注意力窗口。

### 3. 做完就更新
完成任意阶段后立刻更新计划文件：
- 用 `[x]` 标记已完成阶段
- 更新“状态”区域
- 记录遇到的任何错误

### 4. 落盘，不塞爆
大段内容写进文件，而不是放在上下文里。上下文里只保留路径与必要摘要。

### 5. 记录所有错误
每个错误都写进“遇到的错误”区域，为后续任务积累可复用的经验。

## 何时使用这套模式

**适用三文件模式：**
- 多步骤任务（3+ 步）
- 调研类任务
- 构建/创作类任务
- 跨多次工具调用的任务
- 任何需要组织与跟踪的工作

**不适用：**
- 简单问答
- 单文件小改
- 快速查询

## 应避免的反模式

| 不要做 | 改为做 |
|--------|--------|
| 用 TodoWrite 作为持久化 | 创建 `task_plan.md` |
| 目标只说一次就不管 | 每次决策前重读计划 |
| 隐藏错误并静默重试 | 在计划文件里记录错误 |
| 把所有内容塞进上下文 | 把大内容写进文件 |
| 一上来就执行 | 先创建计划文件 |

## 进阶用法

更多内容见 [reference.md](reference.md)：
- 注意力操控技巧
- 错误恢复模式
- 来自 Manus 的上下文优化策略

示例见 [examples.md](examples.md)：
- 真实任务示例
- 复杂工作流模式
